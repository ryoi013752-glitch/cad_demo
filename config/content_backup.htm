<h1>About</h1>
<p>課程名稱: 電腦輔助設計與實習</p>
<p>課程評分:</p>
<p style="padding-left: 30px;"><span style="background-color: #ffff00;">學習心得報告 (60%)</span> - MS Teams 線上參與，6人一組每三週發表學習心得。</p>
<p style="padding-left: 60px;">w3、w7、w10、w14、w17、w18</p>
<p style="padding-left: 60px;"><span style="background-color: #ffcc99;">學習心得報告主題</span>:</p>
<p style="padding-left: 60px;">w3: 用什麼套件完成 <a href="https://youtu.be/iOLFP90DneY">5-bar Linkage Plotter</a> 與 <a href="https://mde.tw/cad2025/content/OpenDuck.html">Openduck mini</a> 零組件設計繪圖？ <a href="https://solvespace.com">Solvespace</a>, <a href="https://plm.sw.siemens.com/en-US/nx/cad-online/">Siemens NX</a>, <a href="https://www.onshape.com/en/">Onshape</a> 或其他？各有什麼優缺點？ (<a href="https://mde.tw/cad2025/downloads/plotter.7z">plotter.7z</a>, <a href="/downloads/open_duck_mini.7z">open_duck_mini.7z</a>)</p>
<p style="padding-left: 60px;">w7 (<span style="background-color: #ccffcc;">2a 採 Youtube 影片簡報</span>): <a href="https://youtu.be/iOLFP90DneY">5-bar Linkage Plotter</a> 與 <a href="https://mde.tw/cad2025/content/OpenDuck.html">Openduck mini</a> 零組件設計繪製完成之後，如何切割零件? 為何要切割零件？ 如何利用 <a href="https://cyberbotics.com/">Webots</a> 進行後續的控制系統設計與動態模擬 (Dynamic Simulation)？(<a href="https://mde.tw/cad2025/downloads/plotter_project.7z">plotter_project.7z</a>)</p>
<p style="padding-left: 60px;">w10: <a href="https://cyberbotics.com/">Webots</a> 是什麼？有什麼特點？ 如何進行場景模擬？ 如何用 Python 進行控制系統設計？ (<a href="https://cyberbotics.com/doc/guide/tutorials">Tutorial</a>)</p>
<p style="padding-left: 60px;">w14: <a href="https://cyberbotics.com/">Webots</a> 的模型有沒有辦法用程式方法建立? 有沒有辦法直接從 CAD 套件中轉出 <a href="https://cyberbotics.com/">Webots</a> 的場景模型？</p>
<p style="padding-left: 60px;">w17: 如何實作一套 <a href="https://youtu.be/iOLFP90DneY">5-bar Linkage Plotter</a> 與 <a href="https://mde.tw/cad2025/content/OpenDuck.html">Openduck mini</a>？(<a href="https://la.disneyresearch.com/publication/design-and-control-of-a-bipedal-robotic-character/">Disney Bipedal Robot</a>)</p>
<p style="padding-left: 60px;">w18: 課程總結</p>
<p style="padding-left: 30px;"><span style="background-color: #ffff00;">個人與分組網站維護 (40%)</span> - 每週至少兩次推送與課程進度相關的學習內容與心得。</p>
<p style="padding-left: 60px;">w9 期中自評、w18 期末自評</p>
<h1>Reading</h1>
<p>英文資料基本閱讀能力自我查驗:</p>
<p style="padding-left: 30px;">認不認得這 <a href="/downloads/2000_words.txt">2000_words.txt</a>，<a href="/downloads/5000_words.txt">5000_words.txt</a> 呢?</p>
<h1>CAD</h1>
<p>參數式零組件繪圖相關參考資料:</p>
<p style="padding-left: 30px;">AutoDesk Inventor:</p>
<p style="padding-left: 60px;"><a href="/downloads/autodesk_inventor_api.7z">autodesk_inventor_api.7z</a></p>
<p style="padding-left: 30px;">SolidWorks:</p>
<p style="padding-left: 60px;"><a href="/downloads/solidworks_basics.pdf">solidworks_basics.pdf</a></p>
<p style="padding-left: 60px;"><a href="/downloads/Solidworks_ref.7z">Solidworks_ref.7z</a></p>
<p style="padding-left: 30px;">Siemens NX:</p>
<p style="padding-left: 60px;"><a href="/downloads/nx_python_examples.pdf">nx_python_examples.pdf</a></p>
<p style="padding-left: 60px;"><a href="/downloads/nxopen_python_ref.7z">nxopen_python_ref.7z</a></p>
<p style="padding-left: 60px;"><a href="/downloads/NXOpen_Getting_Started_2017.pdf">NXOpen_Getting_Started_2017.pdf</a></p>
<p style="padding-left: 60px;"><a href="/downloads/NXOpen_Getting_Started_2019.pdf">NXOpen_Getting_Started_2019.pdf</a></p>
<p style="padding-left: 60px;"><a href="/downloads/SNAP_Getting_Started_v12.pdf">SNAP_Getting_Started_v12.pdf</a></p>
<p style="padding-left: 30px;">Solvespace:</p>
<p style="padding-left: 60px;"><a href="/downloads/solvespace-documentation.pdf">solvespace-documentation.pdf</a></p>
<p style="padding-left: 60px;"><a href="https://solvespace.readthedocs.io/en/latest/">https://solvespace.readthedocs.io/en/latest/</a> </p>
<p style="padding-left: 60px;"><a href="https://solvespace.com/tutorial.pl">https://solvespace.com/tutorial.pl</a></p>
<p style="padding-left: 60px;"><a href="https://youtu.be/vBNAIMiomls">https://youtu.be/vBNAIMiomls</a></p>
<p style="padding-left: 60px;"><a href="https://arachnoid.com/Computer_Aided_Design/index.html">https://arachnoid.com/Computer_Aided_Design/index.html</a> </p>
<p style="padding-left: 60px;"><a href="https://news.ycombinator.com/item?id=30625341">https://news.ycombinator.com/item?id=30625341</a> </p>
<p style="padding-left: 60px;"><a href="https://cq.cx/sketchflat.pl">https://cq.cx/sketchflat.pl</a></p>
<p style="padding-left: 60px;"><a href="https://cq.cx/sketchflat-tutorial.p">https://cq.cx/sketchflat-tutorial.p</a>l</p>
<p style="padding-left: 90px;"><a href="/downloads/sketchflat-internals.pdf">sketchflat-internals.pdf</a></p><h1>Design</h1>
<h4>Math</h4>
<p>利用 Python + Sympy 解數學相關題目:</p>
<p style="padding-left: 30px;"><a href="/downloads/taming math and physics using sympy.pdf">taming math and physics using sympy.pdf</a></p>
<p style="padding-left: 30px;"><a href="/downloads/sympy_documentation.pdf">sympy_documentation.pdf</a></p>
<h4>Simulation</h4>
<p style="padding-left: 30px;"><a href="/downloads/modeling and simulation in python.pdf">modeling and simulation in python.pdf</a></p>
<p style="padding-left: 30px;"><a href="/downloads/bond_graph_modeling.pdf">bond_graph_modeling.pdf</a></p>
<h4>Inverse Kinematics:</h4>
<p style="padding-left: 30px;"><a href="/downloads/inverse_kinematics_solution_of_a_robotic_manipulator_using_python_(two_link).pdf">inverse_kinematics_solution_of_a_robotic_manipulator_using_python_(two_link).pdf</a></p>
<p style="padding-left: 30px;"><a href="/downloads/inverse_kinematic_analysis_of_robot_manipulators(dissertation_2015).pdf">inverse_kinematic_analysis_of_robot_manipulators(dissertation_2015).pdf</a></p>
<h4>Mechanical Advantage Analysis:</h4>
<p style="padding-left: 30px;"><a href="/downloads/mechanical_advantage_analysis.pdf">/downloads/mechanical_advantage_analysis.pdf</a></p>
<h4>Webots:</h4>
<p style="padding-left: 30px;"><a href="/downloads/Simulation_of_a_Mobile_Manipulator_on_Webots.pdf">Simulation_of_a_Mobile_Manipulator_on_Webots.pdf</a></p><h1>Plotter</h1>
<p>設計要求:</p>
<p style="padding-left: 30px;">使用平面五連桿設計一套能夠在 <span style="background-color: #ffff99;">20cm x 20cm</span> 範圍中進行繪圖的畫圖機</p>
<p style="padding-left: 30px;">驅動: NEMA 17 步進馬達或 STS3215 系列伺服馬達</p>
<p>首先查詢 NEMA 17 步進馬達與STS3215 系列伺服馬達的規格尺寸。</p>
<p>17 NE2: 42.3mmx42.3mmx34mm (from <a href="https://www.sumfu.com/step/nema17">https://www.sumfu.com/step/nema17</a>)</p>
<p>STS3215: 45.23mmx24.73mmx29mm (from <a href="https://www.feetechrc.com/74v-19-kgcm-plastic-case-metal-tooth-magnetic-code-double-axis-ttl-series-steering-gear.html">FeeTech</a>)</p>
<p>平面五連桿 plotter 自由度如何計算?</p>
<p style="padding-left: 30px;">計算「平面五連桿機構（Five-bar linkage）」的自由度（Degrees of Freedom, DOF）可以使用「Gruebler-Kutzbach 方程式」來處理。</p>
<p style="padding-left: 30px;">平面機構的自由度 = 3(包含地面的構件數 - 1) - 2(有一個自由度的接頭數) - 有兩個自由度的接頭數</p>
<p style="padding-left: 30px;">因此平面五連桿的自由度 = 3(5-1) - 2(5) - 0 = 2，因此設計中的 Plotter 有兩個自由度。</p>
<p>Plotter 尺寸設計:</p>
<p style="padding-left: 30px;">假設左側的馬達中心座標為 (0, 0), 若希望右側的馬達與左側馬達保持水平位置，則右側馬達的座標可設為 (x1, 0), x1 為第一個系統的設計參數。 </p>
<p style="padding-left: 30px;">若希望繪圖區 20cmx20cm 正方形的下方距離馬達 30mm，則繪圖區的左下角點座標為 (0, 30)， 而右下角點座標則為 (200, 30)， 左上角點的座標為 (0, 230)，右上角點的座標為 (200, 230)。</p>
<p style="padding-left: 30px;">因此從左側馬達中心點到繪圖區右上角點的距離為: \[\sqrt{(200^2 + 230^2)}\] = 304.7950</p>
<p style="padding-left: 30px;">若採四個連桿長度都相同的設計，單一桿長的兩倍必須大於 304.7950</p>
<p style="padding-left: 30px;">以下尋找桿長的設計上限:</p>
<p style="padding-left: 60px;">針對希望繪圖區域為 20cmx20cm 的平面五軸 plotter，初步設計內容如下，試問已知兩倍連桿長度必須大於 304.795, 請問能不能針對合理設計找出兩倍連桿長度必須小於多少的約束條件? 假設左側的馬達中心座標為 (0, 0), 若希望右側的馬達與左側馬達保持水平位置，則右側馬達的座標可設為 (x1, 0), x1 為第一個系統的設計參數。 </p>
<p style="padding-left: 60px;">若希望繪圖區 20cmx20cm 正方形的下方距離馬達 30mm，則繪圖區的左下角點座標為 (0, 30)， 而右下角點座標則為 (200, 30)， 左上角點的座標為 (0, 230)，右上角點的座標為 (200, 230)。<br/>因此從左側馬達中心點到繪圖區右上角點的距離為: \[\sqrt{(200^2 + 230^2)}\]</p>
<p style="padding-left: 30px;">針對 \(x\_1 = 200\) mm（左右馬達水平間距）來計算這個五軸平面機構的連桿長度範圍。<br/><br/>一、 左馬達到繪圖區右上角的距離（已知）：<br/><br/>\[<br/>L_{\text{left→RU}} = \sqrt{200^2 + 230^2} = \sqrt{40000 + 52900} = \sqrt{92900} \approx \boxed{304.80 \text{ mm}}<br/>\]<br/><br/><br/>二、右馬達到繪圖區左上角 \((0, 230)\) 的距離：<br/><br/>這是對稱點，對應右馬達控制的最遠點：<br/><br/>\[<br/>L_{\text{right→LU}} = \sqrt{(200)^2 + (230)^2} = \sqrt{92900} \approx \boxed{304.80 \text{ mm}}<br/>\]<br/><br/>因為 \(x_1 = 200\)，所以左右兩馬達的極限距離對稱<br/><br/><br/>所以，兩倍連桿長度的下限為：<br/><br/>\[<br/>\boxed{2L_{\text{min}} &gt; 304.80 \text{ mm}}<br/>\]<br/><br/>三、上限推導：<br/><br/>雖然理論上兩連桿長度可以非常長，但為了避免結構不穩、精度低落、繪圖區域外擴太多，我們以合理幾何極限來限制上限。<br/><br/>最大極限是：<br/><br/>當筆頭落在兩馬達直線中點的正上方（最大高度），也就是在 \((100, y)\)，最高為繪圖區頂端 \(y = 230\)，此時：<br/><br/>\[<br/>L_{\text{center}} = \sqrt{(100)^2 + (230)^2} = \sqrt{10000 + 52900} = \sqrt{62900} \approx \boxed{250.80 \text{ mm}}<br/>\]<br/><br/>所以每支連桿最大約需 250.80 mm，即：<br/><br/>\[<br/>\boxed{2L_{\text{max}} \le 501.60 \text{ mm}}<br/>\]<br/><br/>最終結果（針對 \(x_1 = 200\) mm）：<br/><br/>\[<br/>\boxed{<br/>\text{合理的兩倍連桿長度範圍為：} \quad<br/>\boxed{<br/>304.80 &lt; 2L \le 501.60 \text{ mm}<br/>}<br/>}<br/>\]<br/><br/><br/>建議設計值：<br/><br/>接下來選擇 2L 稍微大於 305 mm，並保留些許餘裕（比如 310\(~\)350 mm）以兼顧活動性與結構穩定性。<br/><br/>例如：<br/><br/>連桿長度 \(L = 160\) mm → 2L = 320 mm <br/>連桿長度 \(L = 175\) mm → 2L = 350 mm <br/><br/>如此 Plotter 不僅可完整覆蓋繪圖區，又不會讓連桿過長造成搖晃或干涉。<br/><br/></p>
<p style="padding-left: 30px;">設計考量:</p>
<p style="padding-left: 30px;"><span style="background-color: #ccffcc;">連桿長度</span>考量:</p>
<p style="padding-left: 60px;">連桿過長會造成機構搖晃、擺動放大<br/><br/>輕微的驅動誤差或彎曲都會被放大，導致筆尖失準<br/><br/>選擇 \(2L \le 350\) mm 能兼顧結構剛性與控制穩定性，因為精簡的設計原則是希望連桿盡可能短而剛性強，只要能覆蓋工作區即可。</p>
<p style="padding-left: 30px;">其次考慮<span style="background-color: #ccffcc;">角度靈活性</span>（Joint Angle Flexibility）</p>
<p style="padding-left: 60px;">在過短的 \(2L\) 情況下，某些筆尖位置需要讓兩個關節角度幾乎伸直或壓扁，會造成奇異點問題（singularity)，控制算法難以計算，且反應變慢、系統容易不穩定。<br/><br/>適度延長 \(2L\) 讓關節角度變化更自然、更靈活，例如筆尖在中間時，兩支連桿不是筆直對拉，而有良好的角度展開。</p>
<p style="padding-left: 30px;">針對<span style="background-color: #ccffcc;">控制精度</span>（Resolution）的考量:</p>
<p style="padding-left: 60px;">以五軸機構而言，連桿越長時，角度一點點改變就會讓筆尖移動很大距離，如此將會造成繪圖解析度下降（resolution drop）。<br/><br/>若 \(2L\) 尺寸選擇遠大於繪圖區，筆尖移動時會有過度放大現象。<br/><br/>因此控制在 \(2L = 310\sim350\) mm 可維持一個平衡的解析度。</p>
<p style="padding-left: 30px;">針對<span style="background-color: #ccffcc;">物理尺寸與成本</span>（Practicality）的考量:</p>
<p style="padding-left: 60px;">太長的連桿會導致整機體積變大，同時讓連桿本體與承載結構變重、造價也會提高。<br/><br/>因此兩倍連桿的長度設計選擇接近下限、但略微加大其尺寸範圍（如 310–350 mm）最符合成本效益與設計效率。</p>
<p>最終 Plotter 尺寸設計採連桿長度 160mm 配置如下:</p>
<p><img alt="" height="259" src="/images/plotter_dimension_design.png" width="300"/></p>
<p><a href="/downloads/plotter_dimension_design.slvs">plotter_dimension_design.slvs</a></p>
<script src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script><h2>自由度</h2>
<p>平面機構的自由度推導:<br/><br/>要解釋 <a href="https://en.wikipedia.org/wiki/Chebychev%E2%80%93Gr%C3%BCbler%E2%80%93Kutzbach_criterion">Grübler 公式</a>（或稱 Kutzbach 公式）如何推導出來，需要從平面機構的運動學基本原理出發，逐步分析構件、自由度和約束的關係。以下是 Grübler 公式的推導過程，針對平面五連桿機構的自由度計算：<br/><br/>Grübler 公式</p>
<p>平面機構的自由度公式為：</p>
<p>\[<br/>DOF = 3(N - 1) - 2J_1 - J_2<br/>\]</p>
<p>其中：</p>
<p>\(DOF\)：機構的自由度。<br/>\(N\)：構件數（包括機架）。<br/>\(J_1\)：一自由度關節數（例如轉動軸或滑動軸）。<br/>\(J_2\)：二自由度關節數。<br/><br/>推導過程</p>
<p>推導 Grübler 公式的核心是計算機構中所有構件的總自由度，然後減去關節施加的約束，得到淨自由度。<br/><br/>一、單一構件的自由度</p>
<p>在平面運動中，每個獨立的構件（不與其他構件連接）有以下自由度：<br/>兩個平移自由度（沿 x 和 y 軸移動）。<br/>一個旋轉自由度（繞 z 軸旋轉，平面運動不考慮其他旋轉）。<br/>因此，每個構件的自由度為 3。<br/><br/>對於一個機構有 \(N\) 個構件（包括機架），總自由度為：</p>
<p>\[<br/>3N<br/>\]<br/><br/>二、固定機架的影響</p>
<p>機構通常有一個固定的構件（機架），其自由度完全被約束（即自由度為 0）。為了計算運動構件的自由度，我們從總構件數中減去機架：</p>
<p>機架數量為 1，剩餘的運動構件數為 \(N - 1\)。<br/>但是，為了統一計算，我們先考慮所有構件的自由度，然後通過約束來減去自由度。<br/><br/>三、關節的約束</p>
<p>關節（joint）限制了構件之間的相對運動，每個關節會減少一定的自由度：</p>
<p>單一自由度關節（例如轉動副或滑動副）：這種關節允許一個自由度（例如只允許旋轉或只允許滑動），因此約束了 2 個自由度（因為每個構件原本有 3 個自由度，關節限制了其中 2 個）。</p>
<p style="padding-left: 30px;">每個一自由度關節的約束數：\(3 - 1 = 2\)。</p>
<p style="padding-left: 30px;">如果有 \(J_1\) 個一自由度關節，總約束為：\(2J_1\)。</p>
<p>兩個自由度關節（例如平面關節，允許兩個平移或一個平移加一個旋轉）：這種關節只約束 1 個自由度。</p>
<p style="padding-left: 30px;">每個二自由度關節的約束數：\(3 - 2 = 1\)。</p>
<p style="padding-left: 30px;">如果有 \(J_2\) 個二自由度關節，總約束為：\(J_2\)。</p>
<p>四、總自由度計算</p>
<p>將所有構件的自由度減去關節的約束，得到機構的總自由度：</p>
<p>\[<br/>DOF = 3N - (2J_1 + J_2)<br/>\]<br/><br/>五、考慮機架的固定</p>
<p>機架作為一個構件，其自由度被完全約束（即 3 個自由度被移除）。因此，我們需要考慮機架的影響：<br/>機架固定相當於減去 1 個構件的自由度，即減去 \(3 \cdot 1 = 3\)。<br/>於是，公式調整為僅考慮運動構件的自由度：</p>
<p>\[<br/>DOF = 3(N - 1) - (2J_1 + J_2)<br/>\]</p>
<p>這就是 Grübler 公式的最終形式。<br/><br/>六、為什麼要減去機架的自由度？</p>
<p>機架固定後，其 3 個自由度（2 個平移 + 1 個旋轉）被約束。<br/>這相當於從總自由度 \(3N\) 中減去機架的 \(3\)，因此使用 \(3(N - 1)\) 來表示運動構件的自由度。<br/><br/>應用到五連桿機構</p>
<p>對於平面五連桿機構：</p>
<p>\(N = 5\)（4 個運動連桿 + 1 個機架）。<br/>\(J_1 = 5\)（5 個轉動副）。<br/>\(J_2 = 0\)（無二自由度關節）。<br/><br/>代入公式：</p>
<p>\[<br/>DOF = 3(5 - 1) - 2 \cdot 5 - 0 = 3 \cdot 4 - 10 = 12 - 10 = 2<br/>\]</p>
<p>自由度為 2，符合五連桿機構的特性。<br/><br/>推導的關鍵假設</p>
<p>一、平面運動：公式假設機構在二維平面內運動，每個構件有 3 個自由度。<br/>二、無冗餘約束：公式假設關節的約束是獨立的。如果機構有冗餘約束（例如平行四邊形結構），自由度可能需要進一步分析。<br/>三、關節類型：公式適用於常見的轉動對、滑動對等，若有特殊關節，需重新計算約束。<br/><br/>特殊情況的考慮</p>
<p>如果機構有冗餘約束（例如某些連桿的運動被重複限制），Grübler 公式可能給出不正確的自由度（例如負值或零），這表示機構可能過約束或需要特殊分析。</p>
<p>對於五連桿機構，若結構為閉環且無冗餘約束，自由度通常為 2，這與實際應用（如繪圖機或機械手臂）一致。</p>
<script src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script><h2>AI_plotter</h2>
<p><img alt="" height="259" src="/images/plotter_dimension_design.png" width="300"/></p>
<p>已知一個平面五連桿繪圖機購得兩個馬達的中心座標位於 (0,0), (200,0), 四根連桿長度皆為 160mm, 若 plotter 繪圖的座標點為 (x,y), (0,0) 位置上的馬達其轉角從正向 X 軸起算, 以逆時針方向為正, 其轉動角度為 t1, 而(200,0) 位置上的馬達其轉角也是從正向 X 軸起算, 也是以逆時針方向為正, 其轉動角度為 t2, 請利用 Python sympy 推導出以 x, y 為輸入變數, 求四組 t1 與 t2 作為輸出的逆向運動方程式。</p>
<p><a href="/downloads/plotter_sympy_inverse_kinematics.py">plotter_sympy_inverse_kinematics.py</a></p>
<p><a href="https://cad.onshape.com/documents/9ebaa0fe12e0330fda26ad1a/w/7f1387b419b76633fa18bb67/e/0f3404b1684ff733f4127c25?renderMode=0&amp;uiState=68d292d7dfd536c40bf38d8d">Plotter in Onshape</a></p>
<p><img caption="false" height="233" src="/images/plotter_in_onshape.png" width="300"/></p>
<p>link1 tip center: -24.436, 158.123, 9 (模型放大兩倍，並轉為 m (-0.048872, 0.316246))<br/>pen center: 96.762, 262.578, -3 (模型放大兩倍，並轉為 m，(0.193524, 0.525156))<br/>link3 tip center: 218.635, 158.911, 15 (模型放大兩倍，並轉為 m，(0.43727, 0.317822))<br/>right motor center: 200, 0, 15 (模型放大兩倍，並轉為 m，(0.4, 0))<br/>left motor center: 0,0,0</p>
<p>Webots 場景檔案:</p>
<p style="padding-left: 30px;"><a href="/downloads/plotter_onshape_w3.7z">plotter_onshape_w3.7z</a> (僅轉入馬達基座與左側 link1)</p>
<p style="padding-left: 30px;"><a href="/downloads/plotter_onshape_w4.7z">plotter_onshape_w4.7z</a> (僅轉入馬達基座、左側link1 與 link2)</p>
<p>採 matplotlib 模擬四種掃掠 20cmx20cm 正方形邊長的逆向運動學 Solutions:</p>
<p><a href="/downloads/cad_demo_sym_formulation.py">cad_demo_sym_formulation.py</a></p>
<p><a href="/downloads/cad_demo_check_sym_sol.py">cad_demo_check_sym_sol.py</a></p>
<p>Python math 格式:</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">def t1_sol1(x, y): return 2 * cmath.atan((320*y - cmath.sqrt(-x**4 - 2*x**2*y**2 + 102400*x**2 - y**4 + 102400*y**2)) / (x**2 + 320*x + y**2))
def t2_sol1(x, y): return 2 * cmath.atan((320*y + cmath.sqrt(-x**4 + 800*x**3 - 2*x**2*y**2 - 137600*x**2 + 800*x*y**2 - 8960000*x - y**4 + 22400*y**2 + 2496000000)) / (x**2 - 720*x + y**2 + 104000))

# Solution 2:
def t1_sol2(x, y): return 2 * cmath.atan((320*y - cmath.sqrt(-x**4 - 2*x**2*y**2 + 102400*x**2 - y**4 + 102400*y**2)) / (x**2 + 320*x + y**2))
def t2_sol2(x, y): return 2 * cmath.atan((320*y - cmath.sqrt(-x**4 + 800*x**3 - 2*x**2*y**2 - 137600*x**2 + 800*x*y**2 - 8960000*x - y**4 + 22400*y**2 + 2496000000)) / (x**2 - 720*x + y**2 + 104000))

# Solution 3:
def t1_sol3(x, y): return 2 * cmath.atan((320*y + cmath.sqrt(-x**4 - 2*x**2*y**2 + 102400*x**2 - y**4 + 102400*y**2)) / (x**2 + 320*x + y**2))
def t2_sol3(x, y): return 2 * cmath.atan((320*y + cmath.sqrt(-x**4 + 800*x**3 - 2*x**2*y**2 - 137600*x**2 + 800*x*y**2 - 8960000*x - y**4 + 22400*y**2 + 2496000000)) / (x**2 - 720*x + y**2 + 104000))

# Solution 4:
def t1_sol4(x, y): return 2 * cmath.atan((320*y + cmath.sqrt(-x**4 - 2*x**2*y**2 + 102400*x**2 - y**4 + 102400*y**2)) / (x**2 + 320*x + y**2))
def t2_sol4(x, y): return 2 * cmath.atan((320*y - cmath.sqrt(-x**4 + 800*x**3 - 2*x**2*y**2 - 137600*x**2 + 800*x*y**2 - 8960000*x - y**4 + 22400*y**2 + 2496000000)) / (x**2 - 720*x + y**2 + 104000))</pre>
<p><img alt="" height="400" src="/images/cad_demo_sym_formulation_result.gif" width="400"/></p>
<p>mathjax 格式:</p>
<p>JSolution 1 (同上列 math 格式 Solution 2):<br/><br/>\[<br/>t_{1} = 2 \operatorname{atan}{\left(\frac{320 y - \sqrt{- x^{4} - 2 x^{2} y^{2} + 102400 x^{2} - y^{4} + 102400 y^{2}}}{x^{2} + 320 x + y^{2}} \right)}<br/>\]<br/><br/>\[<br/>t_{2} = 2 \operatorname{atan}{\left(\frac{320 y - \sqrt{- x^{4} + 800 x^{3} - 2 x^{2} y^{2} - 137600 x^{2} + 800 x y^{2} - 8960000 x - y^{4} + 22400 y^{2} + 2496000000}}{x^{2} - 720 x + y^{2} + 104000} \right)}<br/>\]<br/><br/>JSolution 2 <span>(同上列 math 格式 Solution 1)</span>:<br/><br/>\[<br/>t_{1} = 2 \operatorname{atan}{\left(\frac{320 y - \sqrt{- x^{4} - 2 x^{2} y^{2} + 102400 x^{2} - y^{4} + 102400 y^{2}}}{x^{2} + 320 x + y^{2}} \right)}<br/>\]<br/><br/>\[<br/>t_{2} = 2 \operatorname{atan}{\left(\frac{320 y + \sqrt{- x^{4} + 800 x^{3} - 2 x^{2} y^{2} - 137600 x^{2} + 800 x y^{2} - 8960000 x - y^{4} + 22400 y^{2} + 2496000000}}{x^{2} - 720 x + y^{2} + 104000} \right)}<br/>\]<br/><br/>JSolution 3 <span>(同上列 math 格式 Solution 4)</span>:<br/><br/>\[<br/>t_{1} = 2 \operatorname{atan}{\left(\frac{320 y + \sqrt{- x^{4} - 2 x^{2} y^{2} + 102400 x^{2} - y^{4} + 102400 y^{2}}}{x^{2} + 320 x + y^{2}} \right)}<br/>\]<br/><br/>\[<br/>t_{2} = 2 \operatorname{atan}{\left(\frac{320 y - \sqrt{- x^{4} + 800 x^{3} - 2 x^{2} y^{2} - 137600 x^{2} + 800 x y^{2} - 8960000 x - y^{4} + 22400 y^{2} + 2496000000}}{x^{2} - 720 x + y^{2} + 104000} \right)}<br/>\]<br/><br/>JSolution 4 <span>(同上列 math 格式 Solution 3)</span><span>:</span>:<br/><br/>\[<br/>t_{1} = 2 \operatorname{atan}{\left(\frac{320 y + \sqrt{- x^{4} - 2 x^{2} y^{2} + 102400 x^{2} - y^{4} + 102400 y^{2}}}{x^{2} + 320 x + y^{2}} \right)}<br/>\]<br/><br/>\[<br/>t_{2} = 2 \operatorname{atan}{\left(\frac{320 y + \sqrt{- x^{4} + 800 x^{3} - 2 x^{2} y^{2} - 137600 x^{2} + 800 x y^{2} - 8960000 x - y^{4} + 22400 y^{2} + 2496000000}}{x^{2} - 720 x + y^{2} + 104000} \right)}<br/>\]</p>
<p>上列符號式求解(Symbolic Formulation)與圖形法求解進行比較:</p>
<p style="padding-left: 30px;">Plotter 到達點 (200, 230) 時的 t1 與 t2 角度（degree）:<br/><br/>JSolution 3 <span>(同上列 math 格式 Solution 4)</span>:</p>
<p style="padding-left: 30px;">t1 = 66.72°</p>
<p style="padding-left: 30px;">t2 = 45.95°</p>
<script src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script><h2>P_onshape</h2>
<p><img caption="false" height="234" src="/images/plotter_in_onshape.png" width="300"/></p>
<p></p>
<p><a href="/downloads/plotter_dimension_design_2.slvs">plotter_dimension_design_2.slvs</a></p>
<p><a href="/downloads/webots_plotter_sympy.py">webots_plotter_sympy.py</a></p>
<p><a href="/downloads/webots_verification.py">webots_verification.py</a></p>
<p><img alt="" height="400" src="/images/webots_plotter_sympy.gif" width="400"/></p>
<pre class="brush:html;auto-links:false;toolbar:false" contenteditable="false">import cmath
import math

# Solution 3:
def t1_sol3(x, y):
    rad = 2.0 * cmath.atan(
        (1280.0 * y + cmath.sqrt(
            -4000000.0 * x**4
            - 3200000.0 * x**3
            - 8000000.0 * x**2 * y**2
            - 4000000.0 * x**2 * y
            + 178400.0 * x**2
            - 3200000.0 * x * y**2
            - 1600000.0 * x * y
            + 327360.0 * x
            - 4000000.0 * y**4
            - 4000000.0 * y**3
            - 181600.0 * y**2
            + 409200.0 * y
            + 125911.0
        ) + 320.0) / (
            2000.0 * x**2 + 2080.0 * x + 2000.0 * y**2 + 1000.0 * y + 461.0
        )
    )
    return math.degrees(rad.real)

def t2_sol3(x, y):
    rad = 2.0 * cmath.atan(
        (1280.0 * y - cmath.sqrt(
            -4000000.0 * x**4
            + 3200000.0 * x**3
            - 8000000.0 * x**2 * y**2
            - 4000000.0 * x**2 * y
            + 178400.0 * x**2
            + 3200000.0 * x * y**2
            + 1600000.0 * x * y
            - 327360.0 * x
            - 4000000.0 * y**4
            - 4000000.0 * y**3
            - 181600.0 * y**2
            + 409200.0 * y
            + 125911.0
        ) + 320.0) / (
            2000.0 * x**2 + 480.0 * x + 2000.0 * y**2 + 1000.0 * y - 51.0
        )
    )
    return math.degrees(rad.real)

# 測試
print(t1_sol3(0.2, 0.185), t2_sol3(0.2, 0.185))
</pre>
<p><span>利用右上方最遠的繪圖點進行上列 Solution 3 方程式查驗:</span></p>
<p><span><a href="/downloads/plotter_dimension_design_2.slvs">plotter_dimension_design_2.slvs</a></span></p>
<p><span><a href="/downloads/webots_ik_right_top_corner.py">webots_ik_right_top_corner.py</a> 執行控制後機構模擬如下，之後可以修改此一程式透過 t1_ik(x, y) 與 t2_ik(x, y) 求得 plotter 繪圖點座標設置為繪圖區各點時的 t1 與 t2 馬達旋轉角度，其量測參考線為馬達右側的水平線作為起點，且逆時針方向為正。</span></p>
<p><span>plotter 零組件轉檔、 Webots 場景與控制器程式: <a href="/downloads/plotter_onshape_w5.7z">plotter_onshape_w5.7z</a>，請各組根據此參考資料，嘗試讓 plotter 可以在繪圖區 (目前為 0.4mx0.4m) 繪製任何線架構圖形。</span></p>
<p><span><img alt="" height="297" src="/images/webots_ik_right_top_corner.py.png" width="300"/></span></p>
<hr/>
<p><span><a href="/downloads/webots_check_sol3.py">webots_check_sol3.py</a></span></p>
<p><span>pythonw.exe -u "webots_check_sol3.py"<br/>--- Solution 3 at P(0.2, 0.185) ---<br/>t1 (Radians): (1.221335238965607+0j)<br/>t2 (Radians): (0.7473365120313953+0j)<br/>------------------------------------------<br/>t1 (Degrees): 69.9774 degrees<br/>t2 (Degrees): 42.8192 degrees</span></p>
<p><span><img caption="false" height="254" src="/images/webots_check_sol3.png" width="300"/></span></p><h2>P_webots</h2>
<p>Webots 場景中的 hingejoint 是以機構的初始角度作為 0 度。</p>
<p>轉入 Webots 的 <a href="https://cad.onshape.com/documents/9ebaa0fe12e0330fda26ad1a/w/7f1387b419b76633fa18bb67/e/0f3404b1684ff733f4127c25?renderMode=0&amp;uiState=68d292d7dfd536c40bf38d8d">Plotter in Onshape</a> 其機構初始設置為:</p>
<p><img alt="" height="300" src="/images/webots_plotter_initial_conf.png" width="300"/></p>
<p>若以逆時針轉角為正， t1 必須反轉 8.78 度才能達到垂直的位置，而 t2 則必須正轉 6.69 度才能達到垂直的位置。</p>
<p>若兩個馬達都以水平線作為 0 度，則處了考慮從垂直角度位置，還必須逆轉 90 度才能到達水平的零點轉角位置。</p>
<p>此一角度座標定義，可以利用 <a href="/downloads/webots_plotter_zero_degree.py">webots_plotter_zero_degree.py</a> 控制程式，讓兩個馬達的轉角設置在水平位置。</p>
<p><img alt="" height="265" src="/images/webots_plotter_zeor_degree.png" width="300"/></p>
<p><a href="/downloads/plotter_onshape_w4.7z">plotter_onshape_w4.7z</a></p>
<hr/>
<p>兩種建立剛體的方法 url 給定 OBJ 或 STL 檔案所在相對位置:</p>
<p style="padding-left: 30px;"><a href="https://cyberbotics.com/doc/reference/solid">Solid</a> - <a href="https://cyberbotics.com/doc/reference/shape">Shape</a> - <a href="https://cyberbotics.com/doc/reference/mesh">Mesh</a> - url</p>
<p style="padding-left: 30px;"><a href="https://cyberbotics.com/doc/reference/cadshape">CadShape</a> - url</p>
<p>利用 boundingObject 界定物件碰撞檢測範圍:</p>
<p style="padding-left: 30px;">boundingObject USE shape</p>
<p><a href="https://cyberbotics.com/doc/reference/solidreference">SolidReference</a> 設定於 link3 端點，且參照 link4_solid，表示第四旋轉軸既位於 link3，同時也必須位於 link4，讓 Webots 透過此一 closed chain 約束條件，於系統方程式運算時，能夠模擬封閉連桿機構的運動。</p>
<p><img alt="" height="253" src="/images/plotter_project_SolidReference.png" width="300"/></p>
<p>從 <a href="https://cad.onshape.com/documents/9ebaa0fe12e0330fda26ad1a/w/7f1387b419b76633fa18bb67/e/0f3404b1684ff733f4127c25?renderMode=0&amp;uiState=68d292d7dfd536c40bf38d8d">Plotter in Onshape</a> 以 <a href="https://en.wikipedia.org/wiki/STL_(file_format)">STL</a> 格式轉出後，利用 <a href="/downloads/plotter_onshape/cad/split_stl_to_obj_scale2_w_mtl.py">split_stl_to_obj_scale2_w_mtl.py</a>，以兩倍原始尺寸分割零件為 <a href="https://en.wikipedia.org/wiki/Wavefront_.obj_file">OBJ</a> 格式後，轉進 Webots 建立第一階段的模擬場景: 僅 link1 轉動: <a href="/downloads/plotter_onshape_link1.7z">plotter_onshape_link1.7z</a></p><h1>Openduck</h1>
<p><a href="https://github.com/apirrone/Open_Duck_Mini">Open Duck Mini</a> 是一款模組化、開源的雙足仿生機器人平台，專為教育與研究設計，具備高自由度與低成本特性。</p>
<p><img caption="false" height="298" src="/images/openduck_mini.png" width="200"/></p>
<p>設計規格：</p>
<ol>
<li>使用 12 顆 <a href="https://www.feetechrc.com/74v-19-kgcm-plastic-case-metal-tooth-magnetic-code-double-axis-ttl-series-steering-gear.html">FeeTech STS3215</a> 伺服馬達（7.4V，19kg·cm 扭矩）+ 2 顆 <a href="https://www.amazon.com/dp/B0FJQZSFMS">Miuzei 9g 輔助伺服</a>，實現 14 個自由度（雙足腿部 10 DOF，頭頸 4 DOF），支援穩定步態、轉向與精確感測定位。</li>
<li>機身採用 3D 列印（PLA 機身硬性結構/TPU 腳底軟性結構），尺寸約 42cm 高，總重約 1.0–1.3kg。</li>
<li>控制單元為 <a href="https://www.taiwaniot.com.tw/product/raspberry-pi-zero-wh/">Raspberry Pi Zero WH</a>，支援 Wi-Fi/Bluetooth 與模組化感測器擴充（如 IMU、攝影機）。電源為 7.4V 2S（2 顆 <a href="https://www.taiwaniot.com.tw/product/panasonic-ncr18650ga-3450mah/">18650 電池</a>），峰值電流 4–7A。提供 <a href="https://cad.onshape.com/documents/64074dfcfa379b37d8a47762/w/3650ab4221e215a4f65eb7fe/e/0505c262d882183a25049d05">CAD</a>、韌體與原始碼，採開放授權，零件公開取得，BOM 總成本約$400 美元。</li>
</ol>